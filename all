function doGet(e) {
  var params = JSON.stringify(e);
  return HtmlService.createHtmlOutput(params);
}

function doGet(e) {
  var params = e.parameter;
  writeJSONtoSheet(params);
  Logger.log(params);
  
}

function getTitle(){
  
}

function logSheetInfo() {
  var sheet = SpreadsheetApp.getActiveSheet();
  var data = sheet.getDataRange().getValues();
  for (var i = 0; i < data.length; i++) {
    Logger.log('Product name: ' + data[i][0]);
    Logger.log('Product number: ' + data[i][1]);
  }
}

function writeJSONtoSheet(json) {

  var sheet = SpreadsheetApp.getActiveSheet();

  var keys = Object.keys(json).sort();
  var last = sheet.getLastColumn();
  var header = sheet.getRange(1, 1, 1, last).getValues()[0];
  var newCols = [];

  for (var k = 0; k < keys.length; k++) {
    if (header.indexOf(keys[k]) === -1) {
      newCols.push(keys[k]);
    }
  }

  if (newCols.length > 0) {
    sheet.insertColumnsAfter(last, newCols.length);
    sheet.getRange(1, last + 1, 1, newCols.length).setValues([newCols]);
    header = header.concat(newCols);
  }

  var row = [];

  for (var h = 0; h < header.length; h++) {
    row.push(header[h] in json ? json[header[h]] : "");
  }

  sheet.appendRow(row);

}

https://docs.google.com/spreadsheets/d/1FlXLTC1EvK3oD6mMAZ8dJSNoUkXKJCLJ5uRWOfRT7zo/edit?usp=sharing



function doGet(e) {
  var params = JSON.stringify(e);
  var json = {"title": "title", "next": "test"};
  addProduct();
   var sheet = SpreadsheetApp.getActiveSheet();
   var range1 = sheet.getRange(1, 1).getValues();
   var range2 = sheet.getRange(1, 1, 3).getValues();
   var range3 = sheet.getRange(1, 1, 3, 3).getValues();
   Logger.log(range1);
  Logger.log(range2);
  Logger.log(range3);
  writeJSONtoSheet(json)
  return HtmlService.createHtmlOutput(params);
}

function doPost(e){
 var sheet = SpreadsheetApp.getActiveSheet();
 var length = e.contentLength;
 var body = e.postData.contents;
 var jsonString = e.postData.getDataAsString();
 var jsonData = JSON.parse(jsonString);
  Logger.log(jsonData)
 sheet.appendRow([jsonData.ti, length]);
  sheet.appendRow(["new"]);
  sheet.appendRow(["shiiiiiiit"]);
  var MyResponse = "works";
  return ContentService.createTextOutput(e.parameter.callback+ "("+MyResponse+")").setMimeType(ContentService.MimeType.JAVASCRIPT);
}

function addProduct() {
  var sheet = SpreadsheetApp.getActiveSheet();
  sheet.appendRow(['Cotton Sweatshirt XL', 'css004']);
}

function writeJSONtoSheet(json) {

  var sheet = SpreadsheetApp.getActiveSheet();

  var keys = Object.keys(json).sort();
  var last = sheet.getLastColumn();
  var header = sheet.getRange(1, 1, 1, last).getValues()[0];
  Logger.log(header);
  var newCols = [];

  for (var k = 0; k < keys.length; k++) {
    if (header.indexOf(keys[k]) === -1) {
      newCols.push(keys[k]);
    }
  }

  if (newCols.length > 0) {
    sheet.insertColumnsAfter(last, newCols.length);
    sheet.getRange(1, last + 1, 1, newCols.length).setValues([newCols]);
    header = header.concat(newCols);
  }

  var row = [];

  for (var h = 0; h < header.length; h++) {
    row.push(header[h] in json ? json[header[h]] : "");
  }

  sheet.appendRow(row);

}